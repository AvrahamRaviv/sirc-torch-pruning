# step 1: init Pruner, at trainer.py:
# a. import
"""
from torch_pruning.utils.pruning_utils import Pruning
"""
# b. init:
"""
# init pruner
if self.cfg.do_prun:
    self.pruner = Pruning(model, save_root, self.forward_pass_train, self._log, self.device, train_loader=self.train_loader)
"""

# c. prune at init (if needed):
"""
# channel pruning at initialization
if self.cfg.do_prun:
    self.pruner.prune(self.model, self.i_epoch, self._log)
"""

# step 2: Regularization, at trainer.py:
"""
if self.cfg.do_prun:
    reg_loss = self.pruner.channel_regularize(self.model)  # sparsity regularization
"""

# step 3: Pruning/Masking, at trainer.py:
"""
# pruning
if self.cfg.do_prun:
    self.pruner.prune(self.model, self.i_epoch, self._log)
"""

# load pruned model extension, at models.utils:
"""
replace "model.load_state_dict(weights)" by:
try:
    model.load_state_dict(weights)
except Exception:
    from torch_pruning.utils import load_state_dict_pruned
    model = load_state_dict_pruned(model, weights)