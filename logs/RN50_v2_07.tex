2026-02-13 05:21:23,029 | INFO | Logging to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_imagenet.log
2026-02-13 05:21:23,029 | INFO | ============================================================
2026-02-13 05:21:23,029 | INFO | VBP ImageNet Reproduction Script
2026-02-13 05:21:23,029 | INFO | ============================================================
2026-02-13 05:21:23,029 | INFO |   model_type: cnn
2026-02-13 05:21:23,029 | INFO |   model_name: /algo/NetOptimization/outputs/VBP/ResNet50_TP/resnet50_imagenet1k.pth
2026-02-13 05:21:23,029 | INFO |   cnn_arch: resnet50
2026-02-13 05:21:23,029 | INFO |   pretrained: True
2026-02-13 05:21:23,029 | INFO |   interior_only: True
2026-02-13 05:21:23,029 | INFO |   data_path: /algo/NetOptimization/outputs/VBP/
2026-02-13 05:21:23,029 | INFO |   train_batch_size: 64
2026-02-13 05:21:23,029 | INFO |   val_batch_size: 128
2026-02-13 05:21:23,030 | INFO |   num_workers: 4
2026-02-13 05:21:23,030 | INFO |   max_batches: 200
2026-02-13 05:21:23,030 | INFO |   keep_ratio: 0.7
2026-02-13 05:21:23,030 | INFO |   global_pruning: True
2026-02-13 05:21:23,030 | INFO |   max_pruning_ratio: 1.0
2026-02-13 05:21:23,030 | INFO |   norm_per_layer: False
2026-02-13 05:21:23,030 | INFO |   no_compensation: False
2026-02-13 05:21:23,030 | INFO |   no_recalib: False
2026-02-13 05:21:23,030 | INFO |   criterion: variance
2026-02-13 05:21:23,030 | INFO |   epochs_ft: 10
2026-02-13 05:21:23,030 | INFO |   lr_ft: 0.01
2026-02-13 05:21:23,030 | INFO |   opt_ft: sgd
2026-02-13 05:21:23,030 | INFO |   momentum_ft: 0.9
2026-02-13 05:21:23,030 | INFO |   wd_ft: 0.0001
2026-02-13 05:21:23,030 | INFO |   use_kd: True
2026-02-13 05:21:23,030 | INFO |   kd_alpha: 0.7
2026-02-13 05:21:23,030 | INFO |   kd_T: 2.0
2026-02-13 05:21:23,030 | INFO |   pat: False
2026-02-13 05:21:23,030 | INFO |   pat_steps: 5
2026-02-13 05:21:23,030 | INFO |   pat_epochs_per_step: 3
2026-02-13 05:21:23,030 | INFO |   var_loss_weight: 0.0
2026-02-13 05:21:23,030 | INFO |   sparse_mode: none
2026-02-13 05:21:23,030 | INFO |   epochs_sparse: 5
2026-02-13 05:21:23,030 | INFO |   lr_sparse: 0.0001
2026-02-13 05:21:23,030 | INFO |   l1_lambda: 0.0001
2026-02-13 05:21:23,030 | INFO |   gmp_target_sparsity: 0.5
2026-02-13 05:21:23,030 | INFO |   disable_ddp: False
2026-02-13 05:21:23,031 | INFO |   local_rank: 0
2026-02-13 05:21:23,031 | INFO |   save_dir: /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7
2026-02-13 05:21:23,031 | INFO |   rank: 0
2026-02-13 05:21:23,031 | INFO |   world_size: 2
2026-02-13 05:21:23,031 | INFO | Loading ImageNet dataset...
2026-02-13 05:21:23,032 | INFO | Using cached sample lists for fast loading
2026-02-13 05:21:23,416 | INFO | Train samples: 1281167, Val samples: 50000
2026-02-13 05:21:25,452 | INFO | Loaded resnet50 (pretrained=True)
2026-02-13 05:21:26,534 | INFO | Baseline: 4.12G MACs, 25.56M params
2026-02-13 05:21:26,535 | INFO | Evaluating original model...
2026-02-13 05:22:47,494 | INFO | Original accuracy: 0.8035, loss: 1.4124
2026-02-13 05:22:47,517 | INFO | Created teacher model for knowledge distillation
2026-02-13 05:22:47,517 | INFO | PAT: 1 steps, per_step_keep=0.7000, epochs_per_step=0, target_keep=0.7, criterion=variance
2026-02-13 05:22:47,517 | INFO | 
============================================================
2026-02-13 05:22:47,517 | INFO | PAT Step 1/1
2026-02-13 05:22:47,517 | INFO | ============================================================
2026-02-13 05:22:47,542 | INFO | Auto-detected 53 CNN target layers for stats
2026-02-13 05:22:47,542 | INFO | Collecting activation variance statistics...
2026-02-13 05:23:10,038 | INFO | Statistics collected for 53 layers
2026-02-13 05:23:10,039 | INFO |   Conv2d: mean_var=5.530585
2026-02-13 05:23:10,039 | INFO |   Conv2d: mean_var=1.093802
2026-02-13 05:23:10,039 | INFO |   Conv2d: mean_var=2.082016
2026-02-13 05:23:10,039 | INFO |   Conv2d: mean_var=13.851697
2026-02-13 05:23:10,039 | INFO |   Conv2d: mean_var=16.785677
2026-02-13 05:23:10,201 | INFO | Variance — entropy=0.9313, cv=1.5036, gini=0.6157
2026-02-13 05:23:10,247 | INFO | Pruning: per_step_prune=0.3000
2026-02-13 05:23:10,801 | INFO | Pruning complete (criterion=VBP, compensation=on)
2026-02-13 05:23:10,801 | INFO | Recalibrating BN running stats...
2026-02-13 05:23:11,603 | INFO | BN recalib [1/100]
2026-02-13 05:23:11,956 | INFO | BN recalib [6/100]
2026-02-13 05:23:12,818 | INFO | BN recalib [11/100]
2026-02-13 05:23:13,342 | INFO | BN recalib [16/100]
2026-02-13 05:23:14,028 | INFO | BN recalib [21/100]
2026-02-13 05:23:14,460 | INFO | BN recalib [26/100]
2026-02-13 05:23:14,895 | INFO | BN recalib [31/100]
2026-02-13 05:23:15,299 | INFO | BN recalib [36/100]
2026-02-13 05:23:16,015 | INFO | BN recalib [41/100]
2026-02-13 05:23:16,388 | INFO | BN recalib [46/100]
2026-02-13 05:23:16,784 | INFO | BN recalib [51/100]
2026-02-13 05:23:17,164 | INFO | BN recalib [56/100]
2026-02-13 05:23:17,856 | INFO | BN recalib [61/100]
2026-02-13 05:23:18,214 | INFO | BN recalib [66/100]
2026-02-13 05:23:18,612 | INFO | BN recalib [71/100]
2026-02-13 05:23:18,967 | INFO | BN recalib [76/100]
2026-02-13 05:23:19,704 | INFO | BN recalib [81/100]
2026-02-13 05:23:20,082 | INFO | BN recalib [86/100]
2026-02-13 05:23:20,603 | INFO | BN recalib [91/100]
2026-02-13 05:23:20,981 | INFO | BN recalib [96/100]
2026-02-13 05:23:21,499 | INFO | BN recalib [100/100]
2026-02-13 05:23:22,074 | INFO | BN recalibration done (100 batches)
2026-02-13 05:24:41,669 | INFO | Step 1 retention: acc=0.6584, loss=3.0397
2026-02-13 05:24:41,670 | INFO |   cumulative_keep=0.7000, MACs=3.17G, params=15.90M
2026-02-13 05:24:41,670 | INFO | 
Post-prune fine-tuning for 10 epochs (sgd, lr=0.01, wd=0.0001)...
2026-02-13 05:24:42,763 | INFO | FT 1 [1/10009] loss=2.3160
2026-02-13 05:26:14,629 | INFO | FT 1 [501/10009] loss=1.3115
2026-02-13 05:27:46,945 | INFO | FT 1 [1001/10009] loss=1.2542
2026-02-13 05:29:18,871 | INFO | FT 1 [1501/10009] loss=1.2184
2026-02-13 05:30:51,126 | INFO | FT 1 [2001/10009] loss=1.1955
2026-02-13 05:32:23,168 | INFO | FT 1 [2501/10009] loss=1.1802
2026-02-13 05:33:55,005 | INFO | FT 1 [3001/10009] loss=1.1686
2026-02-13 05:35:26,988 | INFO | FT 1 [3501/10009] loss=1.1596
2026-02-13 05:36:58,831 | INFO | FT 1 [4001/10009] loss=1.1513
2026-02-13 05:38:30,871 | INFO | FT 1 [4501/10009] loss=1.1461
2026-02-13 05:40:02,756 | INFO | FT 1 [5001/10009] loss=1.1419
2026-02-13 05:41:34,564 | INFO | FT 1 [5501/10009] loss=1.1378
2026-02-13 05:43:06,566 | INFO | FT 1 [6001/10009] loss=1.1334
2026-02-13 05:44:38,386 | INFO | FT 1 [6501/10009] loss=1.1294
2026-02-13 05:46:10,275 | INFO | FT 1 [7001/10009] loss=1.1259
2026-02-13 05:47:42,243 | INFO | FT 1 [7501/10009] loss=1.1236
2026-02-13 05:49:14,118 | INFO | FT 1 [8001/10009] loss=1.1218
2026-02-13 05:50:46,093 | INFO | FT 1 [8501/10009] loss=1.1196
2026-02-13 05:52:17,933 | INFO | FT 1 [9001/10009] loss=1.1178
2026-02-13 05:53:49,760 | INFO | FT 1 [9501/10009] loss=1.1157
2026-02-13 05:55:21,748 | INFO | FT 1 [10001/10009] loss=1.1138
2026-02-13 05:55:23,254 | INFO | FT 1 [10009/10009] loss=1.1138
2026-02-13 05:56:47,274 | INFO | FT ep 1/10: train_loss=1.1138, val_acc=0.7475
2026-02-13 05:56:47,451 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 05:56:49,531 | INFO | FT 2 [1/10009] loss=0.9065
2026-02-13 05:58:21,068 | INFO | FT 2 [501/10009] loss=1.0435
2026-02-13 05:59:53,025 | INFO | FT 2 [1001/10009] loss=1.0489
2026-02-13 06:01:24,785 | INFO | FT 2 [1501/10009] loss=1.0509
2026-02-13 06:02:56,563 | INFO | FT 2 [2001/10009] loss=1.0522
2026-02-13 06:04:28,477 | INFO | FT 2 [2501/10009] loss=1.0516
2026-02-13 06:06:00,164 | INFO | FT 2 [3001/10009] loss=1.0506
2026-02-13 06:07:32,044 | INFO | FT 2 [3501/10009] loss=1.0510
2026-02-13 06:09:03,834 | INFO | FT 2 [4001/10009] loss=1.0515
2026-02-13 06:10:35,538 | INFO | FT 2 [4501/10009] loss=1.0513
2026-02-13 06:12:07,466 | INFO | FT 2 [5001/10009] loss=1.0525
2026-02-13 06:13:39,190 | INFO | FT 2 [5501/10009] loss=1.0535
2026-02-13 06:15:10,893 | INFO | FT 2 [6001/10009] loss=1.0539
2026-02-13 06:16:42,850 | INFO | FT 2 [6501/10009] loss=1.0548
2026-02-13 06:18:14,569 | INFO | FT 2 [7001/10009] loss=1.0552
2026-02-13 06:19:46,276 | INFO | FT 2 [7501/10009] loss=1.0553
2026-02-13 06:21:18,484 | INFO | FT 2 [8001/10009] loss=1.0558
2026-02-13 06:22:50,199 | INFO | FT 2 [8501/10009] loss=1.0556
2026-02-13 06:24:22,047 | INFO | FT 2 [9001/10009] loss=1.0565
2026-02-13 06:25:53,914 | INFO | FT 2 [9501/10009] loss=1.0565
2026-02-13 06:27:25,608 | INFO | FT 2 [10001/10009] loss=1.0561
2026-02-13 06:27:27,105 | INFO | FT 2 [10009/10009] loss=1.0560
2026-02-13 06:28:50,742 | INFO | FT ep 2/10: train_loss=1.0560, val_acc=0.7478
2026-02-13 06:28:50,937 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 06:28:52,032 | INFO | FT 3 [1/10009] loss=1.2371
2026-02-13 06:30:23,770 | INFO | FT 3 [501/10009] loss=1.0185
2026-02-13 06:31:55,945 | INFO | FT 3 [1001/10009] loss=1.0206
2026-02-13 06:33:27,945 | INFO | FT 3 [1501/10009] loss=1.0259
2026-02-13 06:34:59,735 | INFO | FT 3 [2001/10009] loss=1.0239
2026-02-13 06:36:31,620 | INFO | FT 3 [2501/10009] loss=1.0253
2026-02-13 06:38:03,712 | INFO | FT 3 [3001/10009] loss=1.0265
2026-02-13 06:39:35,508 | INFO | FT 3 [3501/10009] loss=1.0260
2026-02-13 06:41:07,398 | INFO | FT 3 [4001/10009] loss=1.0276
2026-02-13 06:42:39,342 | INFO | FT 3 [4501/10009] loss=1.0293
2026-02-13 06:44:11,156 | INFO | FT 3 [5001/10009] loss=1.0326
2026-02-13 06:45:43,070 | INFO | FT 3 [5501/10009] loss=1.0322
2026-02-13 06:47:15,192 | INFO | FT 3 [6001/10009] loss=1.0321
2026-02-13 06:48:46,933 | INFO | FT 3 [6501/10009] loss=1.0331
2026-02-13 06:50:18,871 | INFO | FT 3 [7001/10009] loss=1.0342
2026-02-13 06:51:50,671 | INFO | FT 3 [7501/10009] loss=1.0353
2026-02-13 06:53:22,355 | INFO | FT 3 [8001/10009] loss=1.0354
2026-02-13 06:54:54,344 | INFO | FT 3 [8501/10009] loss=1.0369
2026-02-13 06:56:26,124 | INFO | FT 3 [9001/10009] loss=1.0370
2026-02-13 06:57:57,875 | INFO | FT 3 [9501/10009] loss=1.0374
2026-02-13 06:59:29,825 | INFO | FT 3 [10001/10009] loss=1.0375
2026-02-13 06:59:31,318 | INFO | FT 3 [10009/10009] loss=1.0375
2026-02-13 07:00:53,908 | INFO | FT ep 3/10: train_loss=1.0375, val_acc=0.7520
2026-02-13 07:00:54,056 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 07:00:55,099 | INFO | FT 4 [1/10009] loss=0.9198
2026-02-13 07:02:26,722 | INFO | FT 4 [501/10009] loss=1.0007
2026-02-13 07:03:58,479 | INFO | FT 4 [1001/10009] loss=1.0097
2026-02-13 07:05:30,216 | INFO | FT 4 [1501/10009] loss=1.0099
2026-02-13 07:07:02,152 | INFO | FT 4 [2001/10009] loss=1.0103
2026-02-13 07:08:33,852 | INFO | FT 4 [2501/10009] loss=1.0093
2026-02-13 07:10:05,628 | INFO | FT 4 [3001/10009] loss=1.0139
2026-02-13 07:11:37,846 | INFO | FT 4 [3501/10009] loss=1.0143
2026-02-13 07:13:09,561 | INFO | FT 4 [4001/10009] loss=1.0145
2026-02-13 07:14:41,493 | INFO | FT 4 [4501/10009] loss=1.0158
2026-02-13 07:16:13,751 | INFO | FT 4 [5001/10009] loss=1.0169
2026-02-13 07:17:45,528 | INFO | FT 4 [5501/10009] loss=1.0171
2026-02-13 07:19:17,369 | INFO | FT 4 [6001/10009] loss=1.0182
2026-02-13 07:20:49,527 | INFO | FT 4 [6501/10009] loss=1.0194
2026-02-13 07:22:21,254 | INFO | FT 4 [7001/10009] loss=1.0193
2026-02-13 07:23:53,139 | INFO | FT 4 [7501/10009] loss=1.0187
2026-02-13 07:25:25,033 | INFO | FT 4 [8001/10009] loss=1.0182
2026-02-13 07:26:56,781 | INFO | FT 4 [8501/10009] loss=1.0181
2026-02-13 07:28:28,925 | INFO | FT 4 [9001/10009] loss=1.0185
2026-02-13 07:30:00,714 | INFO | FT 4 [9501/10009] loss=1.0191
2026-02-13 07:31:32,692 | INFO | FT 4 [10001/10009] loss=1.0192
2026-02-13 07:31:34,170 | INFO | FT 4 [10009/10009] loss=1.0192
2026-02-13 07:32:56,962 | INFO | FT ep 4/10: train_loss=1.0192, val_acc=0.7542
2026-02-13 07:32:57,102 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 07:32:58,578 | INFO | FT 5 [1/10009] loss=0.9481
2026-02-13 07:34:30,042 | INFO | FT 5 [501/10009] loss=0.9829
2026-02-13 07:36:02,151 | INFO | FT 5 [1001/10009] loss=0.9859
2026-02-13 07:37:34,172 | INFO | FT 5 [1501/10009] loss=0.9868
2026-02-13 07:39:05,912 | INFO | FT 5 [2001/10009] loss=0.9879
2026-02-13 07:40:37,722 | INFO | FT 5 [2501/10009] loss=0.9894
2026-02-13 07:42:09,586 | INFO | FT 5 [3001/10009] loss=0.9889
2026-02-13 07:43:41,369 | INFO | FT 5 [3501/10009] loss=0.9895
2026-02-13 07:45:13,313 | INFO | FT 5 [4001/10009] loss=0.9910
2026-02-13 07:46:45,390 | INFO | FT 5 [4501/10009] loss=0.9913
2026-02-13 07:48:17,147 | INFO | FT 5 [5001/10009] loss=0.9902
2026-02-13 07:49:49,110 | INFO | FT 5 [5501/10009] loss=0.9911
2026-02-13 07:51:20,836 | INFO | FT 5 [6001/10009] loss=0.9918
2026-02-13 07:52:52,616 | INFO | FT 5 [6501/10009] loss=0.9917
2026-02-13 07:54:24,584 | INFO | FT 5 [7001/10009] loss=0.9913
2026-02-13 07:55:56,611 | INFO | FT 5 [7501/10009] loss=0.9917
2026-02-13 07:57:28,277 | INFO | FT 5 [8001/10009] loss=0.9918
2026-02-13 07:59:00,253 | INFO | FT 5 [8501/10009] loss=0.9918
2026-02-13 08:00:31,951 | INFO | FT 5 [9001/10009] loss=0.9919
2026-02-13 08:02:03,966 | INFO | FT 5 [9501/10009] loss=0.9924
2026-02-13 08:03:36,142 | INFO | FT 5 [10001/10009] loss=0.9922
2026-02-13 08:03:37,634 | INFO | FT 5 [10009/10009] loss=0.9923
2026-02-13 08:04:59,375 | INFO | FT ep 5/10: train_loss=0.9923, val_acc=0.7608
2026-02-13 08:04:59,518 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 08:05:00,597 | INFO | FT 6 [1/10009] loss=1.0671
2026-02-13 08:06:32,173 | INFO | FT 6 [501/10009] loss=0.9616
2026-02-13 08:08:04,111 | INFO | FT 6 [1001/10009] loss=0.9617
2026-02-13 08:09:35,948 | INFO | FT 6 [1501/10009] loss=0.9636
2026-02-13 08:11:07,996 | INFO | FT 6 [2001/10009] loss=0.9642
2026-02-13 08:12:39,926 | INFO | FT 6 [2501/10009] loss=0.9634
2026-02-13 08:14:11,636 | INFO | FT 6 [3001/10009] loss=0.9631
2026-02-13 08:15:43,545 | INFO | FT 6 [3501/10009] loss=0.9640
2026-02-13 08:17:15,467 | INFO | FT 6 [4001/10009] loss=0.9643
2026-02-13 08:18:47,231 | INFO | FT 6 [4501/10009] loss=0.9633
2026-02-13 08:20:19,121 | INFO | FT 6 [5001/10009] loss=0.9635
2026-02-13 08:21:50,887 | INFO | FT 6 [5501/10009] loss=0.9625
2026-02-13 08:23:22,606 | INFO | FT 6 [6001/10009] loss=0.9624
2026-02-13 08:24:54,603 | INFO | FT 6 [6501/10009] loss=0.9624
2026-02-13 08:26:26,316 | INFO | FT 6 [7001/10009] loss=0.9629
2026-02-13 08:27:58,060 | INFO | FT 6 [7501/10009] loss=0.9625
2026-02-13 08:29:30,040 | INFO | FT 6 [8001/10009] loss=0.9627
2026-02-13 08:31:01,769 | INFO | FT 6 [8501/10009] loss=0.9621
2026-02-13 08:32:33,530 | INFO | FT 6 [9001/10009] loss=0.9609
2026-02-13 08:34:05,799 | INFO | FT 6 [9501/10009] loss=0.9598
2026-02-13 08:35:37,904 | INFO | FT 6 [10001/10009] loss=0.9592
2026-02-13 08:35:39,394 | INFO | FT 6 [10009/10009] loss=0.9592
2026-02-13 08:37:02,144 | INFO | FT ep 6/10: train_loss=0.9592, val_acc=0.7647
2026-02-13 08:37:02,406 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 08:37:03,409 | INFO | FT 7 [1/10009] loss=0.9511
2026-02-13 08:38:35,015 | INFO | FT 7 [501/10009] loss=0.9272
2026-02-13 08:40:06,694 | INFO | FT 7 [1001/10009] loss=0.9275
2026-02-13 08:41:38,643 | INFO | FT 7 [1501/10009] loss=0.9245
2026-02-13 08:43:10,481 | INFO | FT 7 [2001/10009] loss=0.9232
2026-02-13 08:44:42,283 | INFO | FT 7 [2501/10009] loss=0.9224
2026-02-13 08:46:14,243 | INFO | FT 7 [3001/10009] loss=0.9220
2026-02-13 08:47:45,976 | INFO | FT 7 [3501/10009] loss=0.9228
2026-02-13 08:49:17,716 | INFO | FT 7 [4001/10009] loss=0.9243
2026-02-13 08:50:49,650 | INFO | FT 7 [4501/10009] loss=0.9243
2026-02-13 08:52:21,356 | INFO | FT 7 [5001/10009] loss=0.9245
2026-02-13 08:53:53,173 | INFO | FT 7 [5501/10009] loss=0.9234
2026-02-13 08:55:25,138 | INFO | FT 7 [6001/10009] loss=0.9239
2026-02-13 08:56:57,140 | INFO | FT 7 [6501/10009] loss=0.9237
2026-02-13 08:59:17,362 | INFO | Logging to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_imagenet.log
2026-02-13 08:59:17,363 | INFO | ============================================================
2026-02-13 08:59:17,363 | INFO | VBP ImageNet Reproduction Script
2026-02-13 08:59:17,363 | INFO | ============================================================
2026-02-13 08:59:17,363 | INFO |   model_type: cnn
2026-02-13 08:59:17,363 | INFO |   model_name: /algo/NetOptimization/outputs/VBP/ResNet50_TP/resnet50_imagenet1k.pth
2026-02-13 08:59:17,363 | INFO |   cnn_arch: resnet50
2026-02-13 08:59:17,363 | INFO |   pretrained: True
2026-02-13 08:59:17,363 | INFO |   interior_only: True
2026-02-13 08:59:17,363 | INFO |   data_path: /algo/NetOptimization/outputs/VBP/
2026-02-13 08:59:17,363 | INFO |   train_batch_size: 64
2026-02-13 08:59:17,363 | INFO |   val_batch_size: 128
2026-02-13 08:59:17,363 | INFO |   num_workers: 4
2026-02-13 08:59:17,363 | INFO |   max_batches: 200
2026-02-13 08:59:17,363 | INFO |   keep_ratio: 0.7
2026-02-13 08:59:17,363 | INFO |   global_pruning: True
2026-02-13 08:59:17,363 | INFO |   max_pruning_ratio: 1.0
2026-02-13 08:59:17,363 | INFO |   norm_per_layer: False
2026-02-13 08:59:17,363 | INFO |   no_compensation: False
2026-02-13 08:59:17,363 | INFO |   no_recalib: False
2026-02-13 08:59:17,363 | INFO |   criterion: variance
2026-02-13 08:59:17,363 | INFO |   epochs_ft: 10
2026-02-13 08:59:17,363 | INFO |   lr_ft: 0.01
2026-02-13 08:59:17,364 | INFO |   opt_ft: sgd
2026-02-13 08:59:17,364 | INFO |   momentum_ft: 0.9
2026-02-13 08:59:17,364 | INFO |   wd_ft: 0.0001
2026-02-13 08:59:17,364 | INFO |   use_kd: True
2026-02-13 08:59:17,364 | INFO |   kd_alpha: 0.7
2026-02-13 08:59:17,364 | INFO |   kd_T: 2.0
2026-02-13 08:59:17,364 | INFO |   pat: False
2026-02-13 08:59:17,364 | INFO |   pat_steps: 5
2026-02-13 08:59:17,364 | INFO |   pat_epochs_per_step: 3
2026-02-13 08:59:17,364 | INFO |   var_loss_weight: 0.0
2026-02-13 08:59:17,364 | INFO |   sparse_mode: none
2026-02-13 08:59:17,364 | INFO |   epochs_sparse: 5
2026-02-13 08:59:17,364 | INFO |   lr_sparse: 0.0001
2026-02-13 08:59:17,364 | INFO |   l1_lambda: 0.0001
2026-02-13 08:59:17,364 | INFO |   gmp_target_sparsity: 0.5
2026-02-13 08:59:17,364 | INFO |   disable_ddp: False
2026-02-13 08:59:17,364 | INFO |   local_rank: 0
2026-02-13 08:59:17,364 | INFO |   save_dir: /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7
2026-02-13 08:59:17,364 | INFO |   rank: 0
2026-02-13 08:59:17,364 | INFO |   world_size: 2
2026-02-13 08:59:17,365 | INFO | Loading ImageNet dataset...
2026-02-13 08:59:17,365 | INFO | Using cached sample lists for fast loading
2026-02-13 08:59:17,725 | INFO | Train samples: 1281167, Val samples: 50000
2026-02-13 08:59:19,834 | INFO | Loaded resnet50 (pretrained=True)
2026-02-13 08:59:21,300 | INFO | Baseline: 4.12G MACs, 25.56M params
2026-02-13 08:59:21,301 | INFO | Evaluating original model...
2026-02-13 09:00:27,122 | INFO | Original accuracy: 0.8035, loss: 1.4124
2026-02-13 09:00:27,148 | INFO | Created teacher model for knowledge distillation
2026-02-13 09:00:27,148 | INFO | PAT: 1 steps, per_step_keep=0.7000, epochs_per_step=0, target_keep=0.7, criterion=variance
2026-02-13 09:00:27,148 | INFO | 
============================================================
2026-02-13 09:00:27,148 | INFO | PAT Step 1/1
2026-02-13 09:00:27,148 | INFO | ============================================================
2026-02-13 09:00:27,177 | INFO | Auto-detected 53 CNN target layers for stats
2026-02-13 09:00:27,177 | INFO | Collecting activation variance statistics...
2026-02-13 09:00:47,602 | INFO | Statistics collected for 53 layers
2026-02-13 09:00:47,603 | INFO |   Conv2d: mean_var=5.528597
2026-02-13 09:00:47,603 | INFO |   Conv2d: mean_var=1.092860
2026-02-13 09:00:47,603 | INFO |   Conv2d: mean_var=2.077489
2026-02-13 09:00:47,603 | INFO |   Conv2d: mean_var=13.813391
2026-02-13 09:00:47,603 | INFO |   Conv2d: mean_var=16.750830
2026-02-13 09:00:47,774 | INFO | Variance — entropy=0.9313, cv=1.5021, gini=0.6156
2026-02-13 09:00:47,822 | INFO | Pruning: per_step_prune=0.3000
2026-02-13 09:00:48,340 | INFO | Pruning complete (criterion=VBP, compensation=on)
2026-02-13 09:00:48,340 | INFO | Recalibrating BN running stats...
2026-02-13 09:00:49,085 | INFO | BN recalib [1/100]
2026-02-13 09:00:49,280 | INFO | BN recalib [6/100]
2026-02-13 09:00:49,561 | INFO | BN recalib [11/100]
2026-02-13 09:00:50,030 | INFO | BN recalib [16/100]
2026-02-13 09:00:50,870 | INFO | BN recalib [21/100]
2026-02-13 09:00:51,200 | INFO | BN recalib [26/100]
2026-02-13 09:00:51,596 | INFO | BN recalib [31/100]
2026-02-13 09:00:51,922 | INFO | BN recalib [36/100]
2026-02-13 09:00:52,522 | INFO | BN recalib [41/100]
2026-02-13 09:00:52,871 | INFO | BN recalib [46/100]
2026-02-13 09:00:53,208 | INFO | BN recalib [51/100]
2026-02-13 09:00:53,509 | INFO | BN recalib [56/100]
2026-02-13 09:00:54,039 | INFO | BN recalib [61/100]
2026-02-13 09:00:54,336 | INFO | BN recalib [66/100]
2026-02-13 09:00:54,639 | INFO | BN recalib [71/100]
2026-02-13 09:00:54,999 | INFO | BN recalib [76/100]
2026-02-13 09:00:55,590 | INFO | BN recalib [81/100]
2026-02-13 09:00:55,866 | INFO | BN recalib [86/100]
2026-02-13 09:00:56,249 | INFO | BN recalib [91/100]
2026-02-13 09:00:56,544 | INFO | BN recalib [96/100]
2026-02-13 09:00:56,935 | INFO | BN recalib [100/100]
2026-02-13 09:00:57,481 | INFO | BN recalibration done (100 batches)
2026-02-13 09:02:03,109 | INFO | Step 1 retention: acc=0.6590, loss=3.0631
2026-02-13 09:02:03,110 | INFO |   cumulative_keep=0.7000, MACs=3.17G, params=15.90M
2026-02-13 09:02:03,110 | INFO | 
Post-prune fine-tuning for 10 epochs (sgd, lr=0.01, wd=0.0001)...
2026-02-13 09:02:04,171 | INFO | FT 1 [1/10009] loss=2.6175
2026-02-13 09:03:47,255 | INFO | FT 1 [501/10009] loss=1.3084
2026-02-13 09:05:30,625 | INFO | FT 1 [1001/10009] loss=1.2515
2026-02-13 09:07:13,537 | INFO | FT 1 [1501/10009] loss=1.2182
2026-02-13 09:08:56,527 | INFO | FT 1 [2001/10009] loss=1.1982
2026-02-13 09:10:39,161 | INFO | FT 1 [2501/10009] loss=1.1842
2026-02-13 09:12:22,446 | INFO | FT 1 [3001/10009] loss=1.1715
2026-02-13 09:14:05,802 | INFO | FT 1 [3501/10009] loss=1.1633
2026-02-13 09:15:48,948 | INFO | FT 1 [4001/10009] loss=1.1545
2026-02-13 09:17:32,140 | INFO | FT 1 [4501/10009] loss=1.1500
2026-02-13 09:19:15,188 | INFO | FT 1 [5001/10009] loss=1.1449
2026-02-13 09:20:58,414 | INFO | FT 1 [5501/10009] loss=1.1403
2026-02-13 09:22:41,574 | INFO | FT 1 [6001/10009] loss=1.1366
2026-02-13 09:24:24,737 | INFO | FT 1 [6501/10009] loss=1.1324
2026-02-13 09:26:08,051 | INFO | FT 1 [7001/10009] loss=1.1296
2026-02-13 09:27:51,248 | INFO | FT 1 [7501/10009] loss=1.1259
2026-02-13 09:29:34,551 | INFO | FT 1 [8001/10009] loss=1.1235
2026-02-13 09:31:17,511 | INFO | FT 1 [8501/10009] loss=1.1213
2026-02-13 09:32:59,913 | INFO | FT 1 [9001/10009] loss=1.1194
2026-02-13 09:34:42,887 | INFO | FT 1 [9501/10009] loss=1.1175
2026-02-13 09:36:25,930 | INFO | FT 1 [10001/10009] loss=1.1157
2026-02-13 09:36:27,617 | INFO | FT 1 [10009/10009] loss=1.1157
2026-02-13 09:37:35,799 | INFO | FT ep 1/10: train_loss=1.1157, val_acc=0.7472
2026-02-13 09:37:35,936 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 09:37:36,867 | INFO | FT 2 [1/10009] loss=0.8702
2026-02-13 09:39:19,635 | INFO | FT 2 [501/10009] loss=1.0386
2026-02-13 09:41:02,939 | INFO | FT 2 [1001/10009] loss=1.0428
2026-02-13 09:42:45,967 | INFO | FT 2 [1501/10009] loss=1.0475
2026-02-13 09:44:29,045 | INFO | FT 2 [2001/10009] loss=1.0505
2026-02-13 09:46:11,871 | INFO | FT 2 [2501/10009] loss=1.0526
2026-02-13 09:47:54,786 | INFO | FT 2 [3001/10009] loss=1.0505
2026-02-13 09:49:37,665 | INFO | FT 2 [3501/10009] loss=1.0515
2026-02-13 09:51:20,769 | INFO | FT 2 [4001/10009] loss=1.0521
2026-02-13 09:53:03,664 | INFO | FT 2 [4501/10009] loss=1.0529
2026-02-13 09:54:46,654 | INFO | FT 2 [5001/10009] loss=1.0536
2026-02-13 09:56:29,677 | INFO | FT 2 [5501/10009] loss=1.0542
2026-02-13 09:58:12,613 | INFO | FT 2 [6001/10009] loss=1.0542
2026-02-13 09:59:55,639 | INFO | FT 2 [6501/10009] loss=1.0542
2026-02-13 10:01:38,672 | INFO | FT 2 [7001/10009] loss=1.0539
2026-02-13 10:03:21,617 | INFO | FT 2 [7501/10009] loss=1.0545
2026-02-13 10:05:04,590 | INFO | FT 2 [8001/10009] loss=1.0546
2026-02-13 10:06:47,558 | INFO | FT 2 [8501/10009] loss=1.0551
2026-02-13 10:08:30,519 | INFO | FT 2 [9001/10009] loss=1.0558
2026-02-13 10:10:13,418 | INFO | FT 2 [9501/10009] loss=1.0555
2026-02-13 10:11:55,572 | INFO | FT 2 [10001/10009] loss=1.0556
2026-02-13 10:11:57,222 | INFO | FT 2 [10009/10009] loss=1.0556
2026-02-13 10:13:03,835 | INFO | FT ep 2/10: train_loss=1.0556, val_acc=0.7486
2026-02-13 10:13:04,016 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 10:13:05,051 | INFO | FT 3 [1/10009] loss=1.2296
2026-02-13 10:14:47,792 | INFO | FT 3 [501/10009] loss=1.0214
2026-02-13 10:16:30,717 | INFO | FT 3 [1001/10009] loss=1.0190
2026-02-13 10:18:13,611 | INFO | FT 3 [1501/10009] loss=1.0233
2026-02-13 10:19:56,815 | INFO | FT 3 [2001/10009] loss=1.0239
2026-02-13 10:21:39,736 | INFO | FT 3 [2501/10009] loss=1.0247
2026-02-13 10:23:22,394 | INFO | FT 3 [3001/10009] loss=1.0258
2026-02-13 10:25:05,280 | INFO | FT 3 [3501/10009] loss=1.0261
2026-02-13 10:26:48,116 | INFO | FT 3 [4001/10009] loss=1.0273
2026-02-13 10:28:30,903 | INFO | FT 3 [4501/10009] loss=1.0278
2026-02-13 10:30:13,783 | INFO | FT 3 [5001/10009] loss=1.0303
2026-02-13 10:31:56,646 | INFO | FT 3 [5501/10009] loss=1.0320
2026-02-13 10:33:39,461 | INFO | FT 3 [6001/10009] loss=1.0320
2026-02-13 10:35:22,582 | INFO | FT 3 [6501/10009] loss=1.0334
2026-02-13 10:37:05,634 | INFO | FT 3 [7001/10009] loss=1.0340
2026-02-13 10:38:48,519 | INFO | FT 3 [7501/10009] loss=1.0348
2026-02-13 10:40:31,569 | INFO | FT 3 [8001/10009] loss=1.0349
2026-02-13 10:42:14,591 | INFO | FT 3 [8501/10009] loss=1.0358
2026-02-13 10:43:57,797 | INFO | FT 3 [9001/10009] loss=1.0359
2026-02-13 10:45:40,866 | INFO | FT 3 [9501/10009] loss=1.0359
2026-02-13 10:47:23,714 | INFO | FT 3 [10001/10009] loss=1.0367
2026-02-13 10:47:25,374 | INFO | FT 3 [10009/10009] loss=1.0367
2026-02-13 10:48:32,947 | INFO | FT ep 3/10: train_loss=1.0367, val_acc=0.7481
2026-02-13 10:48:33,975 | INFO | FT 4 [1/10009] loss=0.9513
2026-02-13 10:50:16,345 | INFO | FT 4 [501/10009] loss=1.0024
2026-02-13 10:51:59,415 | INFO | FT 4 [1001/10009] loss=1.0067
2026-02-13 10:53:42,317 | INFO | FT 4 [1501/10009] loss=1.0083
2026-02-13 10:55:25,292 | INFO | FT 4 [2001/10009] loss=1.0103
2026-02-13 10:57:08,123 | INFO | FT 4 [2501/10009] loss=1.0117
2026-02-13 10:58:51,175 | INFO | FT 4 [3001/10009] loss=1.0133
2026-02-13 11:00:34,099 | INFO | FT 4 [3501/10009] loss=1.0146
2026-02-13 11:02:17,275 | INFO | FT 4 [4001/10009] loss=1.0147
2026-02-13 11:04:00,421 | INFO | FT 4 [4501/10009] loss=1.0156
2026-02-13 11:05:43,586 | INFO | FT 4 [5001/10009] loss=1.0168
2026-02-13 11:07:26,764 | INFO | FT 4 [5501/10009] loss=1.0179
2026-02-13 11:09:09,981 | INFO | FT 4 [6001/10009] loss=1.0188
2026-02-13 11:10:53,073 | INFO | FT 4 [6501/10009] loss=1.0196
2026-02-13 11:12:36,337 | INFO | FT 4 [7001/10009] loss=1.0196
2026-02-13 11:14:19,491 | INFO | FT 4 [7501/10009] loss=1.0191
2026-02-13 11:16:02,893 | INFO | FT 4 [8001/10009] loss=1.0186
2026-02-13 11:17:45,953 | INFO | FT 4 [8501/10009] loss=1.0191
2026-02-13 11:19:29,002 | INFO | FT 4 [9001/10009] loss=1.0187
2026-02-13 11:21:12,206 | INFO | FT 4 [9501/10009] loss=1.0190
2026-02-13 11:22:55,532 | INFO | FT 4 [10001/10009] loss=1.0192
2026-02-13 11:22:57,212 | INFO | FT 4 [10009/10009] loss=1.0192
2026-02-13 11:24:03,104 | INFO | FT ep 4/10: train_loss=1.0192, val_acc=0.7543
2026-02-13 11:24:03,253 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 11:24:04,304 | INFO | FT 5 [1/10009] loss=1.1148
2026-02-13 11:25:47,273 | INFO | FT 5 [501/10009] loss=0.9890
2026-02-13 11:27:30,069 | INFO | FT 5 [1001/10009] loss=0.9938
2026-02-13 11:29:12,707 | INFO | FT 5 [1501/10009] loss=0.9928
2026-02-13 11:30:55,865 | INFO | FT 5 [2001/10009] loss=0.9904
2026-02-13 11:32:38,957 | INFO | FT 5 [2501/10009] loss=0.9902
2026-02-13 11:34:22,172 | INFO | FT 5 [3001/10009] loss=0.9920
2026-02-13 11:36:05,358 | INFO | FT 5 [3501/10009] loss=0.9917
2026-02-13 11:37:48,610 | INFO | FT 5 [4001/10009] loss=0.9929
2026-02-13 11:39:31,765 | INFO | FT 5 [4501/10009] loss=0.9933
2026-02-13 11:41:14,966 | INFO | FT 5 [5001/10009] loss=0.9934
2026-02-13 11:42:58,272 | INFO | FT 5 [5501/10009] loss=0.9940
2026-02-13 11:44:41,397 | INFO | FT 5 [6001/10009] loss=0.9942
2026-02-13 11:46:24,757 | INFO | FT 5 [6501/10009] loss=0.9945
2026-02-13 11:48:07,824 | INFO | FT 5 [7001/10009] loss=0.9944
2026-02-13 11:49:51,051 | INFO | FT 5 [7501/10009] loss=0.9944
2026-02-13 11:51:34,176 | INFO | FT 5 [8001/10009] loss=0.9942
2026-02-13 11:53:17,444 | INFO | FT 5 [8501/10009] loss=0.9942
2026-02-13 11:55:00,589 | INFO | FT 5 [9001/10009] loss=0.9945
2026-02-13 11:56:44,042 | INFO | FT 5 [9501/10009] loss=0.9950
2026-02-13 11:58:27,157 | INFO | FT 5 [10001/10009] loss=0.9950
2026-02-13 11:58:28,840 | INFO | FT 5 [10009/10009] loss=0.9949
2026-02-13 11:59:37,894 | INFO | FT ep 5/10: train_loss=0.9949, val_acc=0.7593
2026-02-13 11:59:38,060 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 11:59:39,102 | INFO | FT 6 [1/10009] loss=0.9814
2026-02-13 12:01:21,967 | INFO | FT 6 [501/10009] loss=0.9679
2026-02-13 12:03:05,028 | INFO | FT 6 [1001/10009] loss=0.9679
2026-02-13 12:04:47,978 | INFO | FT 6 [1501/10009] loss=0.9662
2026-02-13 12:06:30,328 | INFO | FT 6 [2001/10009] loss=0.9658
2026-02-13 12:08:13,183 | INFO | FT 6 [2501/10009] loss=0.9652
2026-02-13 12:09:56,090 | INFO | FT 6 [3001/10009] loss=0.9631
2026-02-13 12:11:39,078 | INFO | FT 6 [3501/10009] loss=0.9634
2026-02-13 12:13:22,396 | INFO | FT 6 [4001/10009] loss=0.9628
2026-02-13 12:15:05,524 | INFO | FT 6 [4501/10009] loss=0.9627
2026-02-13 12:16:48,503 | INFO | FT 6 [5001/10009] loss=0.9627
2026-02-13 12:18:31,683 | INFO | FT 6 [5501/10009] loss=0.9623
2026-02-13 12:20:14,830 | INFO | FT 6 [6001/10009] loss=0.9620
2026-02-13 12:21:57,905 | INFO | FT 6 [6501/10009] loss=0.9621
2026-02-13 12:23:41,100 | INFO | FT 6 [7001/10009] loss=0.9627
2026-02-13 12:25:24,390 | INFO | FT 6 [7501/10009] loss=0.9626
2026-02-13 12:27:07,555 | INFO | FT 6 [8001/10009] loss=0.9622
2026-02-13 12:28:51,000 | INFO | FT 6 [8501/10009] loss=0.9616
2026-02-13 12:30:34,462 | INFO | FT 6 [9001/10009] loss=0.9610
2026-02-13 12:32:17,611 | INFO | FT 6 [9501/10009] loss=0.9606
2026-02-13 12:34:00,804 | INFO | FT 6 [10001/10009] loss=0.9609
2026-02-13 12:34:02,467 | INFO | FT 6 [10009/10009] loss=0.9608
2026-02-13 12:35:09,093 | INFO | FT ep 6/10: train_loss=0.9608, val_acc=0.7640
2026-02-13 12:35:09,245 | INFO | New best! Saved to /algo/NetOptimization/outputs/VBP/ResNet50_TP/global_lrv1/kr_0.7/vbp_best.pth
2026-02-13 12:35:10,202 | INFO | FT 7 [1/10009] loss=1.1175
2026-02-13 12:36:53,277 | INFO | FT 7 [501/10009] loss=0.9313
2026-02-13 12:38:36,533 | INFO | FT 7 [1001/10009] loss=0.9286
2026-02-13 12:40:19,819 | INFO | FT 7 [1501/10009] loss=0.9270
